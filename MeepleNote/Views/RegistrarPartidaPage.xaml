<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="MeepleNote.Views.RegistrarPartidaPage"
    Title="Registrar Partida"
    BackgroundColor="{StaticResource BackgroundColor}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">
            <Frame BorderColor="{StaticResource PrimaryColor}" 
                   CornerRadius="12" 
                   Padding="15">
                <VerticalStackLayout Spacing="10">
                    <!-- Mostrar imagen y título del juego -->
                    <Grid ColumnDefinitions="Auto,*">
                        <Image Source="{Binding Juego.FotoPortada}" 
                               WidthRequest="60" 
                               HeightRequest="60"
                               Aspect="AspectFill"/>
                        <Label Grid.Column="1" 
                               Text="{Binding Juego.Titulo}" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               Margin="10,0,0,0"/>
                    </Grid>

                    <Label Text="Fecha de la partida:"/>
                    <DatePicker x:Name="FechaPicker" 
                                Date="{Binding Fecha}"
                                MaximumDate="{Binding TodayDate}"/>

                    <Label Text="Ganador:"/>
                    <Picker x:Name="GanadorPicker"
                            Title="Selecciona un ganador"
                            ItemsSource="{Binding JugadoresParaGanador}"
                            ItemDisplayBinding="{Binding Nombre}"/>


                    <Label Text="Jugadores participantes:"/>
                    <CollectionView x:Name="JugadoresCollection">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="*,Auto" Padding="0,5">
                                    <Entry Text="{Binding Nombre}" 
                                           Placeholder="Nombre jugador"
                                           TextColor="{StaticResource TextColor}"
                                           Completed="OnJugadorEntryCompleted"/>
                                    <Button Grid.Column="1" 
                                            Text="✕" 
                                            Clicked="OnEliminarJugadorClicked"
                                            Style="{StaticResource DangerButton}"
                                            Margin="10,0,0,0"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Button Text="Añadir Jugador" 
                            Clicked="OnAgregarJugadorClicked"
                            Style="{StaticResource SecondaryButton}"/>
                </VerticalStackLayout>
            </Frame>

            <Button Text="Guardar Partida" 
                    Clicked="OnGuardarPartidaClicked"
                    Style="{StaticResource PrimaryButton}"/>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>